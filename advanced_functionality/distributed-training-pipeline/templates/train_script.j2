{%-raw %}
#!/bin/bash
# DO NOT EDIT: Generated by Jinja2
{%-endraw %}

{%-  for item in train.env %}
export {{ item.name }}={{ item.value }}
{%- endfor %}

{%-if git %}
GIT_CLONE_DIR=$HOME/git 
git clone {{ git.repo_url }} $GIT_CLONE_DIR
cd $GIT_CLONE_DIR
{%-if git.branch %}
git checkout {{ git.branch }}
{%-endif %}
{%-if git.commit %}
git fetch origin {{ git.commit }}
git reset --hard {{ git.commit }} 
{%-endif %}
{%-endif %}

{%- for line in pre_script %}
{{ line }}
{%- endfor %} 

{%-  for line in train.command %}
{{ line }} \
{%- endfor %} 

{%- for line in train.args %}
{{ line }} \
{%- endfor %} 
{%- if train.command %}
&& echo "Training script done"
{%- endif %}

{%- for line in post_script %}
{{ line }}
{%- endfor %} 

{%- if git %}
{%- if git.repo_url %}
cd $HOME
rm -rf $GIT_CLONE_DIR
{%- endif %}
{%- endif %}

